# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'C:/Users/user/AppData/Local/Temp/HygieieadmqVww.ui'
#
# Created by: PyQt5 UI code generator 5.15.10
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.
from PyQt5.QtWidgets import QApplication,QMainWindow
import sys
import pandas as pd
from matplotlib import pyplot as plt
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics import accuracy_score, classification_report
from sklearn.model_selection import train_test_split
from wordcloud import WordCloud
# import mysql.connector
from sqlalchemy import create_engine
from sklearn.tree import DecisionTreeClassifier
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression
import seaborn as sns
import pymysql
sns.set_style("whitegrid")
import itertools


# for sqlalchemy reading sql into dataframe
db_url = "mysql+mysqlconnector://root:pharmacist@localhost/hygieia_disease_management"
sql_engine = create_engine(db_url,echo=False)
sql_query = ("""SELECT * FROM symptom JOIN disease ON symptom.disease_id = disease.disease_id""")
patient_table = ("""SELECT * FROM patient""")
hy_df =pd.read_sql(sql_query, sql_engine)
users_df = pd.read_sql(patient_table, sql_engine)
row_count = str(len(users_df)+1)

# Dataframe Exploration analysis
hy_df.set_index('symptom_id', inplace=True)
hy_df.drop(columns = ['disease_id'], inplace = True)
hy_df.head(10)
hy_df.shape
hy_df.describe()
null_checker = hy_df.apply(lambda x: sum(x.isnull())).to_frame(name='count')
unique_disease = hy_df['disease_name'].unique()
unique_symptoms = hy_df.drop(columns = ['disease_name','disease_type'])
disease_freq = hy_df['disease_name'].value_counts()



# To get unique symptoms of each diseases by filteration and looping through the dataframe
mal_rslt = hy_df[hy_df["disease_name"] == 'Malaria']
malaria = []
for columns in mal_rslt:
    for rows in mal_rslt[columns]:
        if rows == 1:
            malaria.append(columns)
mal = (set(malaria))
# print(mal)

dia_rslt = hy_df[hy_df["disease_name"] == 'Diabetes']
diabetes = []
for columns in dia_rslt:
    for rows in dia_rslt[columns]:
        if rows == 1:
            diabetes.append(columns)
diab = (set(diabetes))


hep_rslt = hy_df[hy_df["disease_name"] == 'Hepatitis']
hepatitis = []
for columns in hep_rslt:
    for rows in hep_rslt[columns]:
        if rows == 1:
            hepatitis.append(columns)
hep = (set(hepatitis))

dengue_rslt = hy_df[hy_df["disease_name"] == 'Dengue']
dengue = []
for columns in dengue_rslt:
    for rows in dengue_rslt[columns]:
        if rows == 1:
            dengue.append(columns)
deng = (set(dengue))

pneu_rslt = hy_df[hy_df["disease_name"] == 'Pneumonia']
pneumonia = []
for columns in pneu_rslt:
    for rows in pneu_rslt[columns]:
        if rows == 1:
            pneumonia.append(columns)
pneu = (set(pneumonia))

cov_rslt = hy_df[hy_df["disease_name"] == 'Covid']
covid = []
for columns in cov_rslt:
    for rows in cov_rslt[columns]:
        if rows == 1:
            covid.append(columns)
cov = (set(covid))

ebola_rslt = hy_df[hy_df["disease_name"] == 'Ebola']
ebola = []
for columns in ebola_rslt:
    for rows in ebola_rslt[columns]:
        if rows == 1:
            ebola.append(columns)
eb = set((ebola))


# plotting a bar chart for disease name against count of symptoms

plt.figure(figsize=(12, 6))
plt.barh(disease_freq.index, disease_freq.values, color='green')
plt.xlabel('Count')
plt.ylabel('Disease')
plt.title('Distribution of Diseases')
plt.xticks(rotation=90)
# plt.show()



# Do a correlation analysis here for the features
col_header = unique_symptoms.columns.values.tolist()
# print(col_header)
print(len(col_header))

# Generate Word Cloud for symptoms
all_text = ' '.join(col_header)
wordcloud = WordCloud(width=800, height=400, background_color='white').generate(all_text)


# # Plotting Word Cloud
plt.figure(figsize=(10, 5))
plt.imshow(wordcloud, interpolation='bilinear')
plt.axis('off')
# plt.show()



target = hy_df['disease_name'].values
features = hy_df.drop(columns = ['disease_name','disease_type']).values

X_train, X_test, y_train, y_test = train_test_split(features, target, train_size=0.8, random_state= 42)

model = SVC(kernel="linear")
model_2 = DecisionTreeClassifier()
model_3 = LogisticRegression()
model_4 = RandomForestClassifier()

model.fit(X_train,y_train)
model_2.fit(X_train,y_train)
model_3.fit(X_train,y_train)
model_4.fit(X_train,y_train)

y_predict= model.predict(X_test)
y_predict2= model_2.predict(X_test)
y_predict3= model_3.predict(X_test)
y_predict4= model_4.predict(X_test)

acc_score =accuracy_score(y_test,y_predict)
acc_score2 =accuracy_score(y_test,y_predict2)
acc_score3 =accuracy_score(y_test,y_predict3)
acc_score4 =accuracy_score(y_test,y_predict4)

print ("The accuracy score for SVC model is : ", acc_score)
print ("The accuracy score for DecisionTreeClassifier model is : ", acc_score2)
print ("The accuracy score for LogisticRegression model is : ", acc_score3)
print ("The accuracy score for RandomForestClassifier model is : ", acc_score4)

column_headers = hy_df.drop(columns = ['disease_name','disease_type']).columns.values.tolist()



# THE DESIGN

arr = []
arr1 = []
patient_details_arr =  []

# patient detail
    
# firstname = input("enter first name")

from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QApplication,QMainWindow,QListWidgetItem
import sys

# onlyInt = QIntValidator()


class Ui_MainWindow(object):
    def run(self):
      app=QApplication(sys.argv)
      win=QMainWindow()
      self.setupUi(win)
      win.show()
      sys.exit(app.exec_())




    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(734, 397)
        MainWindow.setStyleSheet("background-color: rgb(108, 221, 255);\n"
"background-color: rgb(243, 243, 243);")
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.gridLayout = QtWidgets.QGridLayout(self.centralwidget)
        self.gridLayout.setObjectName("gridLayout")
        self.title_label = QtWidgets.QLabel(self.centralwidget)
        self.title_label.setMaximumSize(QtCore.QSize(16777215, 50))
        font = QtGui.QFont()
        font.setFamily("Corbel")
        font.setPointSize(20)
        font.setBold(True)
        font.setWeight(75)
        self.title_label.setFont(font)
        self.title_label.setLayoutDirection(QtCore.Qt.RightToLeft)
        self.title_label.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"color: rgb(0, 63, 189);\n"
"background-color: rgb(209, 209, 209);")
        self.title_label.setAlignment(QtCore.Qt.AlignCenter)
        self.title_label.setObjectName("title_label")
        self.gridLayout.addWidget(self.title_label, 0, 0, 1, 1)
        self.tabWidget = QtWidgets.QTabWidget(self.centralwidget)
        font = QtGui.QFont()
        font.setFamily("Corbel")
        font.setPointSize(10)
        font.setBold(True)
        font.setWeight(75)
        self.tabWidget.setFont(font)
        self.tabWidget.setStyleSheet("background-color: rgb(198, 235, 255);")
        self.tabWidget.setTabShape(QtWidgets.QTabWidget.Rounded)
        self.tabWidget.setObjectName("tabWidget")
        self.tab = QtWidgets.QWidget()
        self.tab.setObjectName("tab")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.tab)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.patient_label = QtWidgets.QLabel(self.tab)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(100)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.patient_label.sizePolicy().hasHeightForWidth())
        self.patient_label.setSizePolicy(sizePolicy)
        self.patient_label.setMaximumSize(QtCore.QSize(16777215, 45))
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setPointSize(9)
        font.setBold(False)
        font.setItalic(False)
        font.setWeight(10)
        self.patient_label.setFont(font)
        self.patient_label.setStyleSheet("background-color: rgb(182, 56, 73);\n"
"font: 87 9pt \"Arial Black\";\n"
"\n"
"color: rgb(255, 255, 255);")
        self.patient_label.setObjectName("patient_label")
        self.verticalLayout_2.addWidget(self.patient_label)
        self.label_2 = QtWidgets.QLabel(self.tab)
        self.label_2.setMaximumSize(QtCore.QSize(100, 20))
        self.label_2.setStyleSheet("background-color: rgb(180, 180, 180);\n"
"font: 9pt \"Corbel\";")
        self.label_2.setObjectName("label_2")
        self.verticalLayout_2.addWidget(self.label_2)
        self.firstname_lineEdit = QtWidgets.QLineEdit(self.tab)
        self.firstname_lineEdit.setMaximumSize(QtCore.QSize(300, 30))
        self.firstname_lineEdit.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.firstname_lineEdit.setText("")
        self.firstname_lineEdit.setObjectName("firstname_lineEdit")
        self.verticalLayout_2.addWidget(self.firstname_lineEdit)
        self.label_3 = QtWidgets.QLabel(self.tab)
        self.label_3.setMaximumSize(QtCore.QSize(100, 30))
        self.label_3.setStyleSheet("background-color: rgb(180, 180, 180);\n"
"font: 9pt \"Corbel\";")
        self.label_3.setObjectName("label_3")
        self.verticalLayout_2.addWidget(self.label_3)
        self.lastname_lineEdit = QtWidgets.QLineEdit(self.tab)
        self.lastname_lineEdit.setMaximumSize(QtCore.QSize(300, 30))
        self.lastname_lineEdit.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.lastname_lineEdit.setText("")
        self.lastname_lineEdit.setObjectName("lastname_lineEdit")
        self.verticalLayout_2.addWidget(self.lastname_lineEdit)
        self.label_4 = QtWidgets.QLabel(self.tab)
        self.label_4.setMaximumSize(QtCore.QSize(100, 30))
        self.label_4.setStyleSheet("background-color: rgb(180, 180, 180);\n"
"font: 9pt \"Corbel\";")
        self.label_4.setObjectName("label_4")
        self.verticalLayout_2.addWidget(self.label_4)
        self.age_lineEdit = QtWidgets.QLineEdit(self.tab)
        self.age_lineEdit.setMaximumSize(QtCore.QSize(300, 30))
        self.age_lineEdit.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.age_lineEdit.setText("")
        self.age_lineEdit.setObjectName("age_lineEdit")
        self.verticalLayout_2.addWidget(self.age_lineEdit)
        self.label_5 = QtWidgets.QLabel(self.tab)
        self.label_5.setMaximumSize(QtCore.QSize(100, 30))
        self.label_5.setStyleSheet("background-color: rgb(180, 180, 180);\n"
"font: 9pt \"Corbel\";")
        self.label_5.setObjectName("label_5")
        self.verticalLayout_2.addWidget(self.label_5)
        self.gender_lineEdit = QtWidgets.QLineEdit(self.tab)
        self.gender_lineEdit.setMaximumSize(QtCore.QSize(300, 30))
        self.gender_lineEdit.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.gender_lineEdit.setText("")
        self.gender_lineEdit.setObjectName("gender_lineEdit")
        self.verticalLayout_2.addWidget(self.gender_lineEdit)
        self.label_6 = QtWidgets.QLabel(self.tab)
        self.label_6.setMaximumSize(QtCore.QSize(100, 30))
        self.label_6.setStyleSheet("background-color: rgb(180, 180, 180);\n"
"font: 9pt \"Corbel\";")
        self.label_6.setObjectName("label_6")
        self.verticalLayout_2.addWidget(self.label_6)
        self.weight_lineEdit = QtWidgets.QLineEdit(self.tab)
        self.weight_lineEdit.setMaximumSize(QtCore.QSize(300, 30))
        self.weight_lineEdit.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.weight_lineEdit.setText("")
        self.weight_lineEdit.setObjectName("weight_lineEdit")
        self.verticalLayout_2.addWidget(self.weight_lineEdit)
        self.label_7 = QtWidgets.QLabel(self.tab)
        self.label_7.setMaximumSize(QtCore.QSize(100, 30))
        self.label_7.setStyleSheet("background-color: rgb(180, 180, 180);\n"
"font: 9pt \"Corbel\";")
        self.label_7.setObjectName("label_7")
        self.verticalLayout_2.addWidget(self.label_7)
        self.hereditary_comboBox = QtWidgets.QComboBox(self.tab)
        self.hereditary_comboBox.setMaximumSize(QtCore.QSize(300, 30))
        self.hereditary_comboBox.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.hereditary_comboBox.setObjectName("hereditary_comboBox")
        self.hereditary_comboBox.addItem("")
        self.hereditary_comboBox.addItem("")
        self.verticalLayout_2.addWidget(self.hereditary_comboBox)

        self.pushButton = QtWidgets.QPushButton(self.tab)
        self.pushButton.setMaximumSize(QtCore.QSize(50, 20))
        self.pushButton.setStyleSheet("background-color: rgb(170, 64, 66);\n"
"font: 87 9pt \"Arial Black\";\n"
"color: rgb(255, 255, 255);")
        self.pushButton.setObjectName("pushButton")
        self.verticalLayout_2.addWidget(self.pushButton)

        self.label_18 = QtWidgets.QLabel(self.tab)
        self.label_18.setMaximumSize(QtCore.QSize(250, 16777215))
        self.label_18.setStyleSheet("background-color: rgb(182, 56, 73);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_18.setObjectName("label_18")
        self.verticalLayout_2.addWidget(self.label_18)

        self.label_21 = QtWidgets.QLabel(self.tab)
        self.label_21.setMaximumSize(QtCore.QSize(100, 16777215))
        self.label_21.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(0, 0, 0);")
        self.label_21.setText("")
        self.label_21.setObjectName("label_19")
        self.verticalLayout_2.addWidget(self.label_21)

        self.pushButton_2 = QtWidgets.QPushButton(self.tab)
        self.pushButton_2.setMaximumSize(QtCore.QSize(100, 16777215))
        self.pushButton_2.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.pushButton_2.setObjectName("pushButton_2")
        self.verticalLayout_2.addWidget(self.pushButton_2)


        self.Next_button = QtWidgets.QPushButton(self.tab)
        self.Next_button.setMaximumSize(QtCore.QSize(50, 20))
        self.Next_button.setStyleSheet("background-color: rgb(170, 64, 66);\n"
"font: 87 9pt \"Arial Black\";\n"
"color: rgb(255, 255, 255);")
        self.Next_button.setObjectName("Next_button")
        self.verticalLayout_2.addWidget(self.Next_button)

        

        self.tabWidget.addTab(self.tab, "")
        self.tab_2 = QtWidgets.QWidget()
        self.tab_2.setObjectName("tab_2")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.tab_2)
        self.verticalLayout.setObjectName("verticalLayout")

        self.label = QtWidgets.QLabel(self.tab_2)
        self.label.setMaximumSize(QtCore.QSize(16777215, 45))
        self.label.setStyleSheet("background-color: rgb(182, 56, 73);\n"
"font: 87 9pt \"Arial Black\";\n"
"\n"
"color: rgb(255, 255, 255);")
        self.label.setObjectName("label")
        self.verticalLayout.addWidget(self.label)

        self.symp_listWidget = QtWidgets.QListWidget(self.tab_2)
        self.symp_listWidget.setStyleSheet("background-color: rgb(151, 226, 226);")
        self.symp_listWidget.setObjectName("symp_listWidget")
        self.verticalLayout.addWidget(self.symp_listWidget)

        
        self.label_20 = QtWidgets.QLabel(self.tab_2)
        self.label_20.setMaximumSize(QtCore.QSize(250, 16777215))
        self.label_20.setStyleSheet("background-color: rgb(182, 56, 73);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_20.setObjectName("label_20")
        self.verticalLayout.addWidget(self.label_20)

        self.label_19 = QtWidgets.QLabel(self.tab_2)
        self.label_19.setMaximumSize(QtCore.QSize(100, 16777215))
        self.label_19.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(0, 0, 0);")
        self.label_19.setText("")
        self.label_19.setObjectName("label_19")
        self.verticalLayout.addWidget(self.label_19)

        self.label_9 = QtWidgets.QLabel(self.tab_2)
        self.label_9.setMaximumSize(QtCore.QSize(250, 16777215))
        self.label_9.setStyleSheet("background-color: rgb(182, 56, 73);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_9.setObjectName("label_9")
        self.verticalLayout.addWidget(self.label_9)

        self.label_10 = QtWidgets.QLabel(self.tab_2)
        self.label_10.setMaximumSize(QtCore.QSize(100, 16777215))
        self.label_10.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(0, 0, 0);")
        self.label_10.setText("")
        self.label_10.setObjectName("label_10")
        self.verticalLayout.addWidget(self.label_10)

       
        self.check_pushButton_5 = QtWidgets.QPushButton(self.tab_2)
        self.check_pushButton_5.setMaximumSize(QtCore.QSize(100, 16777215))
        self.check_pushButton_5.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.check_pushButton_5.setObjectName("check_pushButton_5")
        self.verticalLayout.addWidget(self.check_pushButton_5)
        
        
        self.pushButton_3 = QtWidgets.QPushButton(self.tab_2)
        self.pushButton_3.setMaximumSize(QtCore.QSize(100, 16777215))
        self.pushButton_3.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.pushButton_3.setObjectName("pushButton_3")
        self.verticalLayout.addWidget(self.pushButton_3)


        self.Next2_btn = QtWidgets.QPushButton(self.tab_2)
        self.Next2_btn.setMaximumSize(QtCore.QSize(100, 16777215))
        self.Next2_btn.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.Next2_btn.setObjectName("Next2_btn")
        self.verticalLayout.addWidget(self.Next2_btn)

        self.back_button = QtWidgets.QPushButton(self.tab_2)
        self.back_button.setMaximumSize(QtCore.QSize(100, 16777215))
        self.back_button.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.back_button.setObjectName("back_button")
        self.verticalLayout.addWidget(self.back_button)



        
        self.tabWidget.addTab(self.tab_2, "")
        self.tab_3 = QtWidgets.QWidget()
        self.tab_3.setObjectName("tab_3")
        self.verticalLayout_3 = QtWidgets.QVBoxLayout(self.tab_3)
        self.verticalLayout_3.setObjectName("verticalLayout_3")
        self.label_8 = QtWidgets.QLabel(self.tab_3)
        self.label_8.setMaximumSize(QtCore.QSize(1000, 40))
        self.label_8.setStyleSheet("background-color: rgb(182, 56, 73);\n"
"font: 87 9pt \"Arial Black\";\n"
"\n"
"color: rgb(255, 255, 255);")
        self.label_8.setObjectName("label_8")
        self.verticalLayout_3.addWidget(self.label_8)

        self.label_22 = QtWidgets.QLabel(self.tab_3)
        self.label_22.setMaximumSize(QtCore.QSize(200, 100))
        self.label_22.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_22.setObjectName("label_22")
        self.verticalLayout_3.addWidget(self.label_22)

        self.label_23 = QtWidgets.QLabel(self.tab_3)
        self.label_23.setMaximumSize(QtCore.QSize(100, 20))
        self.label_23.setStyleSheet("background-color: rgb(255, 255, 255);\n"
        "font: 9pt \"Corbel\";")
        self.label_23.setText("")
        self.label_23.setObjectName("label_23")
        self.verticalLayout_3.addWidget(self.label_23)

        self.label_11 = QtWidgets.QLabel(self.tab_3)
        self.label_11.setMaximumSize(QtCore.QSize(100, 100))
        self.label_11.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_11.setObjectName("label_11")
        self.verticalLayout_3.addWidget(self.label_11)

        self.malaria_label = QtWidgets.QLabel(self.tab_3)
        self.malaria_label.setMaximumSize(QtCore.QSize(50,20))
        self.malaria_label.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.malaria_label.setText("")
        self.malaria_label.setObjectName("malaria_label")
        self.verticalLayout_3.addWidget(self.malaria_label)

        self.label_12 = QtWidgets.QLabel(self.tab_3)
        self.label_12.setMaximumSize(QtCore.QSize(100, 100))
        self.label_12.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_12.setObjectName("label_12")
        self.verticalLayout_3.addWidget(self.label_12)

        self.dengue_label = QtWidgets.QLabel(self.tab_3)
        self.dengue_label.setMaximumSize(QtCore.QSize(50, 20))
        self.dengue_label.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.dengue_label.setText("")
        self.dengue_label.setObjectName("dengue_label")
        self.verticalLayout_3.addWidget(self.dengue_label)

        self.label_13 = QtWidgets.QLabel(self.tab_3)
        self.label_13.setMaximumSize(QtCore.QSize(100, 100))
        self.label_13.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_13.setObjectName("label_13")
        self.verticalLayout_3.addWidget(self.label_13)

        self.diabetes_label = QtWidgets.QLabel(self.tab_3)
        self.diabetes_label.setMaximumSize(QtCore.QSize(50, 20))
        self.diabetes_label.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.diabetes_label.setText("")
        self.diabetes_label.setObjectName("diabetes_label")
        self.verticalLayout_3.addWidget(self.diabetes_label)

        self.label_14 = QtWidgets.QLabel(self.tab_3)
        self.label_14.setMaximumSize(QtCore.QSize(100, 100))
        self.label_14.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_14.setObjectName("label_14")
        self.verticalLayout_3.addWidget(self.label_14)

        self.pneumonia_label = QtWidgets.QLabel(self.tab_3)
        self.pneumonia_label.setMaximumSize(QtCore.QSize(50, 20))
        self.pneumonia_label.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.pneumonia_label.setText("")
        self.pneumonia_label.setObjectName("pneumonia_label")
        self.verticalLayout_3.addWidget(self.pneumonia_label)

        self.label_15 = QtWidgets.QLabel(self.tab_3)
        self.label_15.setMaximumSize(QtCore.QSize(100, 100))
        self.label_15.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_15.setObjectName("label_15")
        self.verticalLayout_3.addWidget(self.label_15)

        self.hepatitis_label = QtWidgets.QLabel(self.tab_3)
        self.hepatitis_label.setMaximumSize(QtCore.QSize(50, 20))
        self.hepatitis_label.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.hepatitis_label.setText("")
        self.hepatitis_label.setObjectName("hepatitis_label")
        self.verticalLayout_3.addWidget(self.hepatitis_label)

        self.label_16 = QtWidgets.QLabel(self.tab_3)
        self.label_16.setMaximumSize(QtCore.QSize(100, 100))
        self.label_16.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_16.setObjectName("label_16")
        self.verticalLayout_3.addWidget(self.label_16)

        self.covid_label = QtWidgets.QLabel(self.tab_3)
        self.covid_label.setMaximumSize(QtCore.QSize(50, 20))
        self.covid_label.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.covid_label.setText("")
        self.covid_label.setObjectName("covid_label")
        self.verticalLayout_3.addWidget(self.covid_label)

        self.label_17 = QtWidgets.QLabel(self.tab_3)
        self.label_17.setMaximumSize(QtCore.QSize(100, 100))
        self.label_17.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.label_17.setObjectName("label_17")
        self.verticalLayout_3.addWidget(self.label_17)

        self.ebola_label_8 = QtWidgets.QLabel(self.tab_3)
        self.ebola_label_8.setMaximumSize(QtCore.QSize(50, 20))
        self.ebola_label_8.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 9pt \"Corbel\";")
        self.ebola_label_8.setText("")
        self.ebola_label_8.setObjectName("ebola_label_8")
        self.verticalLayout_3.addWidget(self.ebola_label_8)

        self.save_pushButton = QtWidgets.QPushButton(self.tab_3)
        self.save_pushButton.setMaximumSize(QtCore.QSize(100, 16777215))
        self.save_pushButton.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.save_pushButton.setObjectName("save_pushButton")
        self.verticalLayout_3.addWidget(self.save_pushButton)

        self.back2_btn = QtWidgets.QPushButton(self.tab_3)
        self.back2_btn.setMaximumSize(QtCore.QSize(100, 16777215))
        self.back2_btn.setStyleSheet("background-color: rgb(0, 168, 252);\n"
"font: 10pt \"Corbel\";\n"
"color: rgb(255, 255, 255);")
        self.back2_btn.setObjectName("back2_btn")
        self.verticalLayout_3.addWidget(self.back2_btn)

        self.tabWidget.addTab(self.tab_3, "")
        self.gridLayout.addWidget(self.tabWidget, 1, 0, 1, 1)
        MainWindow.setCentralWidget(self.centralwidget)


        

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(0)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)



        
    def get_selected(self,item):
       arr1.append(item.text())

    def button1_clicked(self):
                self.tabWidget.setCurrentIndex(1)

    def button2_clicked(self):
                self.tabWidget.setCurrentIndex(2)     

    def button3_clicked(self):
                self.tabWidget.setCurrentIndex(0) 

    def button4_clicked(self):
                self.tabWidget.setCurrentIndex(1) 
    
    def result(self):
        mal_percentage = self.malaria_label.text()
        deng_percentage = self.dengue_label.text()
        diab_percentage= self.diabetes_label.text()
        pneu_percentage = self.pneumonia_label.text()
        hep_percentage = self.hepatitis_label.text()
        cov_percentage = self.covid_label.text()
        eb_percentage = self.ebola_label_8.text()
        final_result = self.label_23.text()

        result_details = {'malaria_percentage' : mal_percentage,
                           'dengue_percentage' : deng_percentage,
                           'diabetes_percentage' : diab_percentage,
                           'pneumonia_percentage' : pneu_percentage,
                           'hepatitis_percentage' : hep_percentage,
                           'covid_percentage' : cov_percentage,
                           'ebola_percentage' : eb_percentage,
                           'final_result' : final_result}
        df = pd.DataFrame([result_details])
        df.to_sql('result', con=sql_engine, if_exists='append', index=False)

    def retrieve(self):
        firstname = self.firstname_lineEdit.text()
        lastname = self.lastname_lineEdit.text()
        age = self.age_lineEdit.text()
        gender = self.gender_lineEdit.text()
        weight = self.weight_lineEdit.text()
        hereditary = self.hereditary_comboBox.currentText()

        patient_details = {'patient_first_name': firstname, 
                                    'patient_last_name': lastname,
                                    'age': age,
                                    'gender': gender,
                                    'weight' : weight,
                                    'hereditary_status' : hereditary}
        
        df = pd.DataFrame([patient_details])
        df.to_sql('patient', con=sql_engine, if_exists='append', index=False)

        convert_dict = {'age': int,
                'weight': int
                }
        df = df.astype(convert_dict)
        self.label_21.setText(self._translate("MainWindow",row_count))
    

        
    def diagnosis_refresh_button(self):

        arr.clear()
        arr1.clear()
        print(arr)
        print(arr1)

        self.symp_listWidget.clear()
        self.label.clear() 
        self.label_10.clear()
        self.firstname_lineEdit.clear()
        self.lastname_lineEdit.clear()
        self.age_lineEdit.clear()
        self.gender_lineEdit.clear()
        self.weight_lineEdit.clear()
        self.hereditary_comboBox.clear()
        self.malaria_label.clear()
        self.dengue_label.clear()
        self.diabetes_label.clear()
        self.hepatitis_label.clear()
        self.ebola_label_8.clear()
        self.covid_label.clear()
        self.pneumonia_label.clear()
        self.label_23.clear()
        

        for i in col_header:
            # print(i)
            item = QListWidgetItem(i)
            
            item.setFlags(item.flags() | QtCore.Qt.ItemIsUserCheckable)
            item.setCheckState(QtCore.Qt.Unchecked)
            self.symp_listWidget.addItem(item)
        
    def home_refresh_button(self):
        self.firstname_lineEdit.clear()
        self.lastname_lineEdit.clear()
        self.age_lineEdit.clear()
        self.gender_lineEdit.clear()
        self.weight_lineEdit.clear()
        self.hereditary_comboBox.clear()

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        self._translate = _translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.title_label.setText(_translate("MainWindow", "Hygieia Hospital Health Checkup"))
        self.patient_label.setText(_translate("MainWindow", "Patient details"))
        self.label_2.setText(_translate("MainWindow", "First Name"))
        self.firstname_lineEdit.insert(_translate("MainWindow", " "))
        self.label_3.setText(_translate("MainWindow", "Last Name"))
        self.lastname_lineEdit.insert(_translate("MainWindow", " "))
        self.label_4.setText(_translate("MainWindow", "Age"))
        self.age_lineEdit.insert(_translate("MainWindow", " "))
        self.label_5.setText(_translate("MainWindow", "Gender"))
        self.gender_lineEdit.insert(_translate("MainWindow", " "))
        self.label_6.setText(_translate("MainWindow", "Weight"))
        self.weight_lineEdit.insert(_translate("MainWindow", " "))
        self.label_7.setText(_translate("MainWindow", "Heriditary Status"))
        self.hereditary_comboBox.setItemText(0, _translate("MainWindow", "YES"))
        self.hereditary_comboBox.setItemText(1, _translate("MainWindow", "NO"))
        self.pushButton.setText(_translate("MainWindow", "Submit"))
        self.Next_button.setText(_translate("MainWindow", "Next"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("MainWindow", "Home"))
        self.label.setText(_translate("MainWindow", "Select Symptoms"))
        self.label_9.setText(_translate("MainWindow", "Number of Symptom Selected"))
        self.label_20.setText(_translate("MainWindow", "Total Number of Symptom"))
        self.check_pushButton_5.setText(_translate("MainWindow", "check"))
        self.pushButton_2.setText(_translate("MainWindow", "Refresh"))
        self.pushButton_3.setText(_translate("MainWindow", "Refresh"))
        self.Next2_btn.setText(_translate("MainWindow", "Next"))
        self.back_button.setText(_translate("MainWindow", "Back"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_2), _translate("MainWindow", "Diagnosis"))
        self.label_8.setText(_translate("MainWindow", "Result"))
        self.label_22.setText(self._translate("MainWindow", "Disease Prevalence"))
        
        self.label_11.setText(self._translate("MainWindow", "Malaria"))
        self.label_12.setText(self._translate("MainWindow", "Dengue"))
        self.label_13.setText(self._translate("MainWindow", "Diabetes"))
        self.label_14.setText(self._translate("MainWindow", "Pneumonia"))
        self.label_15.setText(self._translate("MainWindow", "Hepatitis"))
        self.label_16.setText(self._translate("MainWindow", "Covid"))
        self.label_17.setText(self._translate("MainWindow", "Ebola"))
        self.label_18.setText(self._translate("MainWindow","Number of Users"))
        self.label_20.setText(self._translate("MainWindow","Total symptoms"))
        self.save_pushButton.setText(_translate("MainWindow", "Save Result"))
        
        self.back2_btn.setText(_translate("MainWindow", "Previous page"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_3), _translate("MainWindow", "Result"))
        self.pushButton.clicked.connect(self.retrieve)
        self.save_pushButton.clicked.connect(self.result)
        self.Next_button.clicked.connect(self.button1_clicked)
        self.Next2_btn.clicked.connect(self.button2_clicked)
        self.back_button.clicked.connect(self.button3_clicked)
        self.back2_btn.clicked.connect(self.button4_clicked)


         
        
    # for the checklist
        for i in col_header:
                item = QListWidgetItem(i)
                item.setFlags(item.flags() | QtCore.Qt.ItemIsUserCheckable)
                item.setCheckState(QtCore.Qt.Unchecked)
                self.symp_listWidget.addItem(item)

        self.symp_listWidget.itemClicked.connect(self.get_selected)  
        
 
# for the check button
        # add signal and slot
        
        self.check_pushButton_5.clicked.connect(self.btn_predict) 

    def btn_predict(self):
              
        selection = ','.join(arr1)
        for i in col_header:
            if selection.find(i) != -1:
                arr.append(1)
            else:
                arr.append(0)


        df_data=pd.Series(arr)
        xdata = df_data.values.reshape(1,-1)
        symptom_selected = str(len(arr1))
        Total_symptoms = str(len(arr))
        total_symp =  len(arr)
        # print(symptom_selected) 
        # print(type(symptom_selected))
        predicted_disease = model_4.predict(xdata)
        print(xdata)
        predict = predicted_disease[0]
        self.label_10.setText(self._translate("MainWindow",symptom_selected))
        self.label_19.setText(self._translate("MainWindow",Total_symptoms))
        self.label_23.setText(self._translate("MainWindow", predict))     
        
        
        mal_count = 0
        diab_count = 0
        deng_count = 0
        hep_count = 0
        cov_count = 0
        eb_count = 0
        pneu_count = 0
        
        print(arr1)
        # print(arr)
        # print(col_header)
        for e in arr1:
                if e in mal:
                        mal_count = mal_count +1
                                                
                elif e in diab:
                        diab_count = diab_count + 1
                        
                elif e in hep:
                        hep_count = hep_count + 1
                                        
                elif e in deng:
                        deng_count = deng_count + 1
                                                
                elif e in pneu:
                        pneu_count = pneu_count + 1
                                                
                elif e in cov:
                        cov_count = cov_count + 1
                                
                elif e in eb:
                        eb_count = eb_count + 1

        # print(arr)
         
            
        mal_perc =str(round((mal_count/total_symp) * 100,2))
        diab_perc =str(round((diab_count/total_symp) * 100,2))
        hep_perc =str(round((hep_count/total_symp) * 100,2))
        deng_perc =str(round((deng_count/total_symp) * 100,2))
        pneu_perc =str(round((pneu_count/total_symp) * 100,2))
        cov_perc =str(round((cov_count/total_symp) * 100,2))
        eb_perc =str(round((mal_count/total_symp) * 100,2))
        self.malaria_label.setText(self._translate("MainWindow", mal_perc))
        self.dengue_label.setText(self._translate("MainWindow", deng_perc))
        self.diabetes_label.setText(self._translate("MainWindow", diab_perc))
        self.pneumonia_label.setText(self._translate("MainWindow", pneu_perc))
        self.hepatitis_label.setText(self._translate("MainWindow", hep_perc))
        self.covid_label.setText(self._translate("MainWindow", cov_perc))
        self.ebola_label_8.setText(self._translate("MainWindow", eb_perc))
        print(mal_perc, deng_perc, diab_perc, pneu_perc, hep_perc, cov_perc, eb_perc )
        #  for refresh button
        
    
        
        self.pushButton_3.clicked.connect(self.diagnosis_refresh_button)
        self.pushButton_2.clicked.connect(self.home_refresh_button)




Ui_MainWindow().run()
